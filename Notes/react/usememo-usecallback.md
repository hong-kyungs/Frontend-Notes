# useMemo ì™€ useCallback

## Memoization

ë©”ëª¨ì´ì œì´ì…˜ì€Â **ê¸°ì¡´ì— ìˆ˜í–‰í•œ ì—°ì‚°ì˜ ê²°ê³¼ê°’ì„ ì–´ë”˜ê°€ì— ì €ì¥í•´ë‘ê³  ë™ì¼í•œ ì…ë ¥ì´ ë“¤ì–´ì˜¤ë©´ ì¬í™œìš©**í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ê¸°ë²•ì…ë‹ˆë‹¤.

ì´ê²ƒì„ ì ì ˆí•˜ê²Œ í™œìš©í•˜ë©´Â **ì¤‘ë³µ ì—°ì‚°**ì„ í”¼í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ë¥¼ ì¡°ê¸ˆ ë” ì“°ë”ë¼ë„ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ì„ ìµœì í™” í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## useMemo

useMemoëŠ” ë©”ëª¨ì´ì œì´ì…˜ëœÂ **ê°’ì„ ë°˜í™˜**í•˜ëŠ” í•¨ìˆ˜ë‹¤. ì¦‰, **ê°’ì„ ìºì‹±í•˜ëŠ” í›…**ì´ë‹¤.

```jsx
useMemo(() => fn, [deps])
```

ì—¬ê¸°ì„œ depsë¡œ ì§€ì •í•œ ê°’ì´ ë³€í•˜ê²Œ ëœë‹¤ë©´ `() => fn` í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê³ , ê·¸ í•¨ìˆ˜ì˜Â **ë°˜í™˜ ê°’ì„ ë°˜í™˜**í•´ì¤€ë‹¤

depsëŠ” dependencyì˜ ì•½ì–´ë¡œ, ì˜ì¡´ì„±ì„ ëœ»í•˜ë©° useMemoê°€ ì´ depsì— ì˜ì¡´í•˜ê³  ìˆë‹¤ëŠ” ê²ƒì„ ë§í•œë‹¤.

```jsx
import React, { useState, useCallback, useMemo } from 'react'

export default function App() {
  const [ex, setEx] = useState(0)
  const [why, setWhy] = useState(0)

  // useMemo ì‚¬ìš©í•˜ê¸°
  useMemo(() => {
    console.log(ex)
  }, [ex])

  // ë‘ ê°œì˜ ë²„íŠ¼ì„ ì„¤ì •í–ˆë‹¤. Xë²„íŠ¼ë§Œì´ exë¥¼ ë³€í™”ì‹œí‚¨ë‹¤.
  return (
    <>
      <button onClick={() => setEx((curr) => curr + 1)}>X</button>
      <button onClick={() => setWhy((curr2) => curr2 + 1)}>Y</button>
    </>
  )
}
```

ì—¬ê¸°ì„œ Xë¼ëŠ” ë²„íŠ¼ì„ í´ë¦­í–ˆì„ ë•Œ setExì— ì˜í•´ì„œ exì˜ ê°’ì„ 1ì”© ì¦ê°€ì‹œí‚¤ëŠ”ë°, exì˜ ê°’ì´ ë³€í•˜ê¸° ë•Œë¬¸ì— useMemoì—ì„œ ì˜ì¡´ì„±ìœ¼ë¡œ ë“±ë¡í•œ exê°€ ë³€í™”ëœ ê²ƒì„ ê°ì§€í•´ ì§€ì •í•œ í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³ , console.logë¡œ ì¸í•´ exê°’ì´ ì¶œë ¥ë˜ê²Œ ëœë‹¤.

### ğŸˆÂ useMemoë¥¼ ì“°ëŠ” ì´ìœ ?

```jsx
import React, { useState, useCallback, useMemo } from 'react'

export default function App() {
  const [ex, setEx] = useState(0)
  const [why, setWhy] = useState(0)

  // ë²„íŠ¼ í´ë¦­ì‹œ exê°’ì´ ì¶œë ¥ëœë‹¤.
  console.log(ex)

  return (
    <>
      <button onClick={() => setEx((curr) => curr + 1)}>X</button>
      <button onClick={() => setWhy((curr2) => curr2 + 1)}>Y</button>
    </>
  )
}
```

<p align="center">
<img src="../../images/react/usememo-usecallback-01.gif" width="300">
</p>

ì»´í¬ë„ŒíŠ¸ì˜Â **state ê°’ì´ ë³€í•˜ë©´ ë¦¬ë Œë”ë§ì´ ì¼ì–´ë‚œë‹¤.** ë²„íŠ¼ì„ í´ë¦­í•  ê²½ìš° setStateë¡œ ì¸í•´ stateê°’ì´ ë³€í™”ë˜ì–´ ë¦¬ë Œë”ë§ì´ ì¼ì–´ë‚˜ë©´ console.logê°€ ì°íˆë„ë¡ ìœ„ì²˜ëŸ¼ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ë˜ëŠ”ë°, useMemoë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ë­˜ê¹Œìš”?

ì‚¬ì‹¤, ìœ„ì²˜ëŸ¼ ì½”ë“œë¥¼ ì‘ì„±í•  ê²½ìš° Xë²„íŠ¼, Yë²„íŠ¼, í˜¹ì€ ì»´í¬ë„ŒíŠ¸ê°€ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì— ì˜í•´ì„œ ë¦¬ë Œë”ë§ì´ ë  ê²½ìš° ìƒíƒœ ê°’ì— ê´€ê³„ ì—†ì´ `console.log`ê°€ ì°íˆëŠ” ì—°ì‚°ì´ ë°œìƒí•˜ê²Œ ëœë‹¤.

ë§Œì•½, ë‹¨ìˆœí•˜ê²Œ `console.log`ê°€ ì•„ë‹Œ ë³µì¡í•œ ì—°ì‚°, ì—°ì‚°í•  ë•Œë§ˆë‹¤ ì•½ 0.3ì´ˆì”© ê±¸ë¦°ë‹¤ê³  ê°€ì •í•˜ë©´ ì–´ë–¨ê¹Œ? ë‹µë‹µí•˜ê² ì§€?

ë”°ë¼ì„œÂ **exê°’ì´ ë³€í•  ê²½ìš°ì—ë§Œ ì—°ì‚°ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ useMemoë¥¼ ì‚¬ìš©í•´ exë¼ëŠ” ë³€ìˆ˜ì— ì˜ì¡´í•˜ë„ë¡ ë“±ë¡**í•˜ëŠ” ê²ƒì´ì§€ìš”.

ê²°ê³¼, ë¦¬ë Œë”ë§ì´ ë°œìƒí•  ê²½ìš°, íŠ¹ì • ë³€ìˆ˜ê°€ ë³€í•  ë•Œì—ë§Œ useMemoì— ë“±ë¡í•œ í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë„ë¡ ì²˜ë¦¬í•˜ë©´ ë¶ˆí•„ìš”í•œ ì—°ì‚°ì„ í•˜ì§€ ì•Šê²Œ ëœë‹¤.

## useCallback

useCallbackì€Â **ë©”ëª¨ì´ì œì´ì…˜ëœ í•¨ìˆ˜ë¥¼ ë°˜í™˜**í•˜ëŠ” íŠ¹ì§•ì„Â ê°€ì§€ê³  ìˆë‹¤. ì¦‰, **í•¨ìˆ˜ë¥¼ ìºì‹±(ë˜ëŠ” ë©”ëª¨ì´ì œì´ì…˜)í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í›…**ì´ë‹¤.

```jsx
useCallback(fn, [deps])
```

useCallback ë˜í•œ deps, ì˜ì¡´ì„±ì´ ìˆëŠ” ê°’ì´ ë³€í•˜ë©´ fnì— ë“±ë¡í•œ í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ” ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆë‹¤.

### ğŸˆÂ useMemoì™€ useCallback ë¹„êµ

**useCallbackì€ í•¨ìˆ˜ ìì²´ë¥¼ ìºì‹±í•˜ê³ , useMemoëŠ” ê°’ì„ ìºì‹±í•œë‹¤.**

```jsx
useCallback(() => {}, [])
useMemo(() => ê°’, [])
```

ë‘˜ ë‹¤ í•¨ìˆ˜ë¥¼ ì²« ë²ˆì§¸ ì¸ìë¡œ ë°›ê³ , ë‘ ë²ˆì§¸ ì¸ìë¡œëŠ” deps ë°°ì—´ì„ ë°›ëŠ”ë‹¤. í•˜ì§€ë§Œ useCallbackì€ () => {} ìì²´ë¥¼ ìºì‹±í•˜ëŠ” ê²ƒì´ê³ , useMemoëŠ” ê°’ë§Œ ìºì‹±í•˜ê²Œ ë©ë‹ˆë‹¤(ë¬¼ë¡  ê°’ì´ í•¨ìˆ˜ì¼ ìˆ˜ëŠ” ìˆë‹¤.). ìºì‹±í•œ ê°’ì„ ë°”ê¾¸ê³  ì‹¶ì„ ë•ŒëŠ” deps ë°°ì—´ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤. deps ë°°ì—´ ë‚´ë¶€ì˜ ê°’ì´ ë‹¬ë¼ì§€ë©´ ê¸°ì¡´ ìºì‹±ëœ ê²ƒì„ ë²„ë¦¬ê³  ìƒˆë¡œ ê°’ì„ êµ¬í•œë‹¤.

```jsx
useMemo(() => console.log(), [test])
const memoizedCallback = useCallback(() => console.log(), [test])
```

ì¼ë‹¨ì€ useMemoì™€ useCallbackì˜ ëª¨ì–‘ì€ ìœ„ì™€ ê°™ë‹¤.
useCallbackì´ í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— ê·¸ í•¨ìˆ˜ë¥¼ ê°€ì§€ëŠ”Â **const ë³€ìˆ˜ì— ì´ˆê¸°í™”**í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì¸ ëª¨ì–‘ì…ë‹ˆë‹¤.

### ğŸˆÂ useCallbackì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

1. ìì‹ ì»´í¬ë„ŒíŠ¸ì— propsë¡œ í•¨ìˆ˜ë¥¼ ì „ë‹¬í•  ê²½ìš°  
   (í•¨ìˆ˜ ìì²´ê°€ ë°”ë€ŒëŠ”ê²Œ ì—†ì–´ë„ ë¶€ëª¨ê°€ ë Œë”ë§ë˜ë©´ ìì‹ì»´í¬ë„ŒíŠ¸ë„ ë¦¬ë Œë”ë§ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.)
2. ì™¸ë¶€ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” apië¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš°

### 1. ìì‹ ì»´í¬ë„ŒíŠ¸ì— propsë¡œ í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ëŠ” ê²½ìš°

ë¨¼ì €Â **í•¨ìˆ˜ëŠ” ê°’ì´ ì•„ë‹Œ ì°¸ì¡°ë¡œ ë¹„êµëœë‹¤!**ëŠ” ì ì„ ì•Œê³  ìˆì–´ì•¼í•œë‹¤.

```jsx
const functionOne = function () {
  return 5
}
const functionTwo = function () {
  return 5
}
// ì„œë¡œì˜ ì°¸ì¡°ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— false
console.log(functionOne === functionTwo)
```

ë™ì¼í•œ ê°’ì„ ë°˜í™˜í•˜ì§€ë§Œ ì°¸ì¡°ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— falseê°€ ë‚˜ì˜¨ë‹¤.
ìœ„ì™€ ê°™ì´ ì»´í¬ë„ŒíŠ¸ì—ì„œ íŠ¹ì • í•¨ìˆ˜ë¥¼ ì •ì˜í•  ê²½ìš° ê°ê°ì˜ í•¨ìˆ˜ë“¤ì€ ëª¨ë‘ ê³ ìœ í•œ í•¨ìˆ˜ê°€ ëœë‹¤.
ì´ëŸ° ê³ ìœ í•œ í•¨ìˆ˜ê°€ ìƒì„±ë  ê²½ìš°, ë¶€ëª¨ë¥¼ í†µí•´ propsì— í•¨ìˆ˜ë¥¼ ì „ë‹¬ë°›ëŠ” ìì‹ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” propsê°€ ë³€ê²½ë˜ì—ˆë‹¤ê³  íŒë‹¨í•´ ë¦¬ë Œë”ë§ì´ ë°œìƒí•˜ê²Œ ëœë‹¤.

```jsx
function App() {
  const [name, setName] = useState('')
  const onSave = () => {}

  return (
    <div className="App">
      <input
        type="text"
        value={name}
        onChange={(e) => setName(e.target.value)}
      />
      <Profile onSave={onSave} />
    </div>
  )
}
```

useCallbackì„ ì‚¬ìš©í•˜ì§€ ì•Šì„ ê²½ìš°,Â nameì´ ë³€ê²½ë˜ì–´ ë¦¬ë Œë”ë§ì´ ë°œìƒí•˜ë©´Â onSaveí•¨ìˆ˜ê°€ ìƒˆë¡œ ë§Œë“¤ì–´ì§€ê³ , Profile ì»´í¬ë„ŒíŠ¸ì˜ propsë¡œ onSaveí•¨ìˆ˜ê°€ ìƒˆë¡œ ì „ë‹¬ë˜ê²Œ ëœë‹¤.  
ì´ë•Œ Profile ì»´í¬ë„ŒíŠ¸ì—ì„œ useMemoë¥¼ ì‚¬ìš©í•´ë„Â **ì´ì „ onSaveì™€ ì´í›„ onSaveê°€ ê°™ì€ ê°’ì„ ë°˜í™˜í•˜ì§€ë§Œ ì°¸ì¡°ê°€ ë‹¤ë¥¸ í•¨ìˆ˜**ê°€ ë˜ì–´ë²„ë¦¬ê¸° ë•Œë¬¸ì— ë¦¬ë Œë”ë§ì´ ì¼ì–´ë‚˜ê²Œ ëœë‹¤.
ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ë§Œ ìˆ˜ì •í•˜ë ¤ê³  í–ˆì§€ë§Œ ì—°ì‡„ì ìœ¼ë¡œ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë“¤ ëª¨ë‘ ë Œë”ë§ì´ ì¼ì–´ë‚˜ê²Œ ë˜ì–´ë²„ë¦°ë‹¤.

ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì´

```jsx
import React, { useCallback, useState } from 'react'
import Profile from './Profile'

function App() {
  const [name, setName] = useState('')
  const onSave = useCallback(() => {
    console.log(name)
  }, [name])

  return (
    <div className="App">
      <input
        type="text"
        value={name}
        onChange={(e) => setName(e.target.value)}
      />
      <Profile onSave={onSave} />
    </div>
  )
}
```

useCallbackì„ ì‚¬ìš©í•´ì„œ onSaveë¼ëŠ” í•¨ìˆ˜ë¥¼ ì¬ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ë Œë”ë§ì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.

### 2. ì™¸ë¶€ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” apië¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš°

```jsx
import React, { useState, useEffect } from 'react'

function Profile({ userId }) {
  const [user, setUser] = useState(null)

  const fetchUser = () =>
    fetch(`https://your-api.com/users/${userId}`)
      .then((response) => response.json())
      .then(({ user }) => user)

  useEffect(() => {
    fetchUser().then((user) => setUser(user))
  }, [fetchUser])

  // ...
}
```

ìœ„ì˜ ì½”ë“œëŠ” fetchUserÂ í•¨ìˆ˜ê°€ ë³€ê²½ë  ë•Œë§Œ ì™¸ë¶€ì—ì„œ apië¥¼ ê°€ì ¸ì™€ useEffectê°€ ì‹¤í–‰ëœë‹¤. ì‚¬ì‹¤ ì´ ì½”ë“œëŠ” ì •ìƒì ì¸ ì½”ë“œê°€ ì•„ë‹ˆë‹¤.  
Profileì´ë¼ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ì´ ë°œìƒí•  ê²½ìš° fetchUser í•¨ìˆ˜ì—ëŠ” ìƒˆë¡œìš´ í•¨ìˆ˜ê°€ í• ë‹¹ë˜ê²Œ ëœë‹¤. ëŸ¬ë©´ useEffect()í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´ user ìƒíƒœê°’ì´ ë°”ë€Œê³ , state ê°’ì´ ë°”ë€Œì—ˆê¸° ë•Œë¬¸ì— ë‹¤ì‹œ ë¦¬ë Œë”ë§ì´ ì¼ì–´ë‚œë‹¤.

**ë¬´í•œë£¨í”„**ì— ë¹ ì ¸ë²„ë¦¬ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.

ì´ë•ŒÂ **useCallbackì„ ì‚¬ìš©í•  ê²½ìš° fetchUser í•¨ìˆ˜ì˜ ì°¸ì¡°ê°’ì„ ë™ì¼í•˜ê²Œ ìœ ì§€**ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
import React, { useState, useEffect } from 'react'

function Profile({ userId }) {
  const [user, setUser] = useState(null)

  const fetchUser = useCallback(
    () =>
      fetch(`https://your-api.com/users/${userId}`)
        .then((response) => response.json())
        .then(({ user }) => user),
    [userId],
  )

  useEffect(() => {
    fetchUser().then((user) => setUser(user))
  }, [fetchUser])

  // ...
}
```

apiì˜ ì˜µì…˜ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” userIdê°€ ë³€ë™ë  ë•Œë§Œ fetchUserì— ìƒˆë¡œìš´ í•¨ìˆ˜ê°€ í• ë‹¹ë˜ë„ë¡ ì„¤ì •í•˜ê³ , ê·¸ê²ƒì´ ì•„ë‹ˆë©´ ë™ì¼í•œ í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê²Œ ë˜ì„œ ë¬´í•œ ë£¨í”„ì— ë¹ ì§€ì§€ ì•Šë„ë¡ í•  ìˆ˜ ìˆë‹¤.

ì°¸ì¡°  
https://narup.tistory.com/273  
[ì œë¡œì´ˆ](https://www.zerocho.com/category/React/post/5f98e5841d7a110004463b87)
